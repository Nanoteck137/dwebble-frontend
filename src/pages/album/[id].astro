---
import AlbumPage from "@components/AlbumPage";
import Layout from "@layouts/Layout.astro";
import { Album } from "src/models/album";
import { Track } from "src/models/track";
import { z } from "zod";

const { id } = Astro.params;

const Response = z.object({
  album: Album,
  tracks: z.array(Track),
});

const j = await fetch(`http://localhost:3000/api/v1/albums/${id}`).then((d) =>
  d.json(),
);
console.log(j);
const data = Response.parse(j);
---

<Layout>
  <AlbumPage album={data.album} tracks={data.tracks} client:load />
</Layout>
